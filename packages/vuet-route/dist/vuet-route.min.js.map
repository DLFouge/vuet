{"version":3,"file":"vuet-route.min.js","sources":["../src/index.js","../../../src/util.js","../../../src/debug.js"],"sourcesContent":["import debug from '../../../src/debug'\nimport util from '../../../src/util'\n\nconst NAME = '__route__'\n\nfunction isWatch (vuet, path, route) {\n  const vtm = vuet.getModule(path)\n  let watch = vtm.route.watch || ['fullPath']\n  watch = Array.isArray(watch) ? watch : [watch]\n  const oldWatch = vuet[NAME][path]\n  vuet[NAME][path] = []\n  watch.forEach(k => {\n    let data = route\n    k.split('.').forEach(chlidKey => {\n      data = data[chlidKey]\n    })\n    vuet[NAME][path].push(JSON.stringify(data))\n  })\n  return oldWatch.join() !== vuet[NAME][path].join()\n}\n\nexport default {\n  init (vuet) {\n    vuet[NAME] = {}\n  },\n  addModule (vuet, path) {\n    vuet[NAME][path] = []\n    const vtm = vuet.getModule(path)\n    if (!util.isObject(vuet.route)) return\n    Object.keys(vtm.route).forEach(k => {\n      if (typeof vtm.route[k] === 'function') {\n        vtm.route[k] = vtm.route[k].bind(vtm)\n      }\n    })\n  },\n  rule ({ path }) {\n    return {\n      beforeCreate () {\n        debug.assertModule(this.$vuet, path)\n        const vtm = this.$vuet.getModule(path)\n        if (isWatch(this.$vuet, path, this.$route)) {\n          vtm.reset()\n          vtm.state.__routeLoaded__ = true\n          return vtm.fetch(vtm)\n        }\n        if (vtm.route.once !== false) { // default\n          return vtm.fetch(vtm)\n        }\n        if (!vtm.state.__routeLoaded__) {\n          return vtm.fetch(vtm)\n        }\n      },\n      watch: {\n        $route: {\n          deep: true,\n          handler (to, from) {\n            const vtm = this.$vuet.getModule(path)\n            if (isWatch(this.$vuet, path, to)) {\n              vtm.reset()\n              vtm.fetch(vtm)\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","const util = {\n  isObject (obj) {\n    return !!obj && Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  getArgMerge () {\n    let opt = {}\n    const args = arguments\n    if (typeof args[0] === 'string') {\n      opt[args[0]] = args.length > 1 ? args[1] : args[0]\n    } else if (args[0] && util.isObject(args[0])) {\n      opt = args[0]\n    }\n    return opt\n  },\n  isPromise (obj) {\n    return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function'\n  }\n}\n\nexport default util\n","import { _Vue } from './vuet-static'\n\nexport default {\n  error (msg) {\n    throw new Error(`[vuet] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vuet] ${msg}`)\n    }\n  },\n  assertModule (vuet, name) {\n    if (name in vuet.modules) {\n      return\n    }\n    this.error(`The '${name}' module does not exist`)\n  },\n  assertVue () {\n    if (!_Vue) {\n      this.error('must call Vue.use(Vuet) before creating a store instance')\n    }\n  },\n  assertPromise () {\n    if (typeof Promise === 'undefined') {\n      this.error('Vuet requires a Promise polyfill in this browser')\n    }\n  }\n}\n"],"names":["isWatch","vuet","path","route","vtm","getModule","watch","Array","isArray","oldWatch","NAME","forEach","data","split","chlidKey","push","JSON","stringify","join","util","obj","Object","prototype","toString","call","opt","args","arguments","length","isObject","then","msg","Error","name","modules","error","Promise","keys","k","bind","assertModule","this","$vuet","$route","reset","state","__routeLoaded__","fetch","once","to","from"],"mappings":"wMAKA,SAASA,GAASC,EAAMC,EAAMC,MACtBC,GAAMH,EAAKI,UAAUH,GACvBI,EAAQF,EAAID,MAAMG,QAAU,cACxBC,MAAMC,QAAQF,GAASA,GAASA,MAClCG,GAAWR,EAAKS,GAAMR,YACvBQ,GAAMR,QACLS,QAAQ,eACRC,GAAOT,IACTU,MAAM,KAAKF,QAAQ,cACZC,EAAKE,OAETJ,GAAMR,GAAMa,KAAKC,KAAKC,UAAUL,MAEhCH,EAASS,SAAWjB,EAAKS,GAAMR,GAAMgB,uNClBxCC,qBACMC,WACCA,GAA+C,oBAAxCC,OAAOC,UAAUC,SAASC,KAAKJ,8BAG3CK,MACEC,EAAOC,gBACU,gBAAZD,GAAK,KACVA,EAAK,IAAMA,EAAKE,OAAS,EAAIF,EAAK,GAAKA,EAAK,GACvCA,EAAK,IAAMP,EAAKU,SAASH,EAAK,QACjCA,EAAK,IAEND,sBAEEL,WACAA,IAAuB,qBAARA,gBAAAA,KAAmC,kBAARA,KAA2C,kBAAbA,GAAIU,yBCZhFC,QACC,IAAIC,iBAAgBD,kBAEtBA,2BAKQ9B,EAAMgC,GACdA,IAAQhC,GAAKiC,cAGZC,cAAcF,wDAIZE,MAAM,sFAIU,mBAAZC,eACJD,MAAM,sDFrBXzB,EAAO,6BAmBLT,KACCS,0BAEIT,EAAMC,KACVQ,GAAMR,SACLE,GAAMH,EAAKI,UAAUH,EACtBiB,GAAKU,SAAS5B,EAAKE,eACjBkC,KAAKjC,EAAID,OAAOQ,QAAQ,YACD,kBAAjBP,GAAID,MAAMmC,OACfnC,MAAMmC,GAAKlC,EAAID,MAAMmC,GAAGC,KAAKnC,2BAI/BF,KAAAA,sCAGIsC,aAAaC,KAAKC,MAAOxC,MACzBE,GAAMqC,KAAKC,MAAMrC,UAAUH,SAC7BF,GAAQyC,KAAKC,MAAOxC,EAAMuC,KAAKE,WAC7BC,UACAC,MAAMC,iBAAkB,EACrB1C,EAAI2C,MAAM3C,KAEI,IAAnBA,EAAID,MAAM6C,KACL5C,EAAI2C,MAAM3C,GAEdA,EAAIyC,MAAMC,uBACN1C,EAAI2C,MAAM3C,yBAKX,mBACG6C,EAAIC,MACL9C,GAAMqC,KAAKC,MAAMrC,UAAUH,EAC7BF,GAAQyC,KAAKC,MAAOxC,EAAM+C,OACxBL,UACAG,MAAM3C"}