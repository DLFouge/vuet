{"version":3,"file":"vuet-scroll.min.js","sources":["../src/vuet-scroll.js","../../../src/debug.js","../src/index.js"],"sourcesContent":["import debug from '../../../src/debug'\n\nconst _self = '__vuetScrollSelf__'\nconst _window = '__vuetScrollWindow__'\n\nclass VuetScroll {\n  constructor (opts) {\n    this.timer = {}\n    this.setOption(opts)\n    this.scrollTo()\n    this.subScroll()\n  }\n  update (opts) {\n    this.setOption(opts)\n    const key = `timer-${this.path}-${this.name}`\n    clearTimeout(this.timer[key])\n    this.timer[key] = setTimeout(() => {\n      this.scrollTo()\n      delete this.timer[key]\n    }, 10)\n  }\n  destroy () {\n    this.app.removeEventListener('scroll', this.subScrolling, false)\n  }\n  setOption (opt) {\n    this.app = opt.app\n    this.path = opt.path\n    this.name = opt.name || ''\n    this.store = opt.store || { x: 0, y: 0 }\n    this.scrolls = opt.scrolls || createScroll(opt)\n    function createScroll (opt) {\n      if (!opt.store.$scroll) {\n        // _Vue.set(opt.store, '$scroll', {})\n      }\n      if (!opt.store.$scroll[opt.name]) {\n        // _Vue.set(opt.store.$scroll, opt.name, { x: 0, y: 0 })\n      }\n\n      return opt.store.$scroll[opt.name]\n    }\n  }\n  scrollTo () {\n    const { app, scrolls } = this\n    if ('scrollTop' in app && app !== window) {\n      app.scrollLeft = scrolls.x\n      app.scrollTop = scrolls.y\n    } else {\n      app.scrollTo(scrolls.x, scrolls.y)\n    }\n  }\n  subScroll () {\n    const { app } = this\n    const newScrolls = { x: 0, y: 0 }\n    this.subScrolling = (event) => {\n      if (app === window) {\n        newScrolls.x = window.pageXOffset\n        newScrolls.y = window.pageYOffset\n      } else {\n        const { scrollTop, scrollLeft, pageXOffset, pageYOffset } = event.target\n        newScrolls.x = scrollLeft || pageYOffset || scrollLeft\n        newScrolls.y = scrollTop || pageXOffset || scrollTop\n      }\n      Object.assign(this.scrolls, newScrolls)\n    }\n    app.addEventListener('scroll', this.subScrolling, false)\n  }\n}\n\nfunction isSelf (modifiers) {\n  return !!(modifiers.window !== true || modifiers.self)\n}\n\nfunction isWindow (modifiers) {\n  return !!(modifiers.window)\n}\n\nexport default {\n  inserted (el, { modifiers, value }, vnode) {\n    if (typeof value.path !== 'string') return debug.error('path is imperative parameter and is string type')\n    if (value.path === 'window') return debug.error('name cannot be the window name')\n    if (isSelf(modifiers)) {\n      if (typeof value.name !== 'string') return debug.error('name is imperative parameter and is string type')\n      el[_self] = new VuetScroll({\n        app: el,\n        path: value.path,\n        name: value.name,\n        store: vnode.context.$vuet.store[value.path],\n        scrolls: value.self\n      })\n    }\n    if (isWindow(modifiers)) {\n      el[_window] = new VuetScroll({\n        app: window,\n        path: value.path,\n        name: 'window',\n        store: vnode.context.$vuet.store[value.path],\n        scrolls: value.window\n      })\n    }\n  },\n  componentUpdated (el, { modifiers, value }, vnode) {\n    if (isSelf(modifiers)) {\n      el[_self].update({\n        app: el,\n        path: value.path,\n        name: value.name,\n        store: vnode.context.$vuet.store[value.path],\n        scrolls: value.self\n      })\n    }\n    if (isWindow(modifiers)) {\n      el[_window].update({\n        app: window,\n        path: value.path,\n        name: 'window',\n        store: vnode.context.$vuet.store[value.path],\n        scrolls: value.window || null\n      })\n    }\n  },\n  unbind (el, { modifiers }) {\n    if (isSelf(modifiers)) {\n      el[_self].destroy()\n      delete el[_self]\n    }\n    if (isWindow(modifiers)) {\n      el[_window].destroy()\n      delete el[_window]\n    }\n  }\n}\n","import { _Vue } from './vuet-static'\n\nexport default {\n  error (msg) {\n    throw new Error(`[vuet] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vuet] ${msg}`)\n    }\n  },\n  assertModule (vuet, name) {\n    if (name in vuet.modules) {\n      return\n    }\n    this.error(`The '${name}' module does not exist`)\n  },\n  assertVue () {\n    if (!_Vue) {\n      this.error('must call Vue.use(Vuet) before creating a store instance')\n    }\n  },\n  assertPromise () {\n    if (typeof Promise === 'undefined') {\n      this.error('Vuet requires a Promise polyfill in this browser')\n    }\n  }\n}\n","import VuetScroll from './vuet-scroll'\n\nexport default {\n  install (Vuet, Vue) {\n    Vue.directive('vuet-scroll', VuetScroll)\n  }\n}\n"],"names":["isSelf","modifiers","window","self","isWindow","msg","Error","vuet","name","modules","error","Promise","_self","_window","VuetScroll","opts","timer","setOption","scrollTo","subScroll","key","this","path","setTimeout","_this","app","removeEventListener","subScrolling","opt","store","x","y","scrolls","$scroll","scrollLeft","scrollTop","newScrolls","event","pageXOffset","pageYOffset","target","assign","_this2","addEventListener","el","vnode","value","debug","context","$vuet","update","destroy","Vuet","Vue","directive"],"mappings":"0MAoEA,SAASA,GAAQC,YACgB,IAArBA,EAAUC,SAAmBD,EAAUE,MAGnD,QAASC,GAAUH,WACPA,EAAUC,iXCtEbG,QACC,IAAIC,iBAAgBD,kBAEtBA,2BAKQE,EAAMC,GACdA,IAAQD,GAAKE,cAGZC,cAAcF,wDAIZE,MAAM,sFAIU,mBAAZC,eACJD,MAAM,sDDtBXE,EAAQ,qBACRC,EAAU,uBAEVC,wBACSC,kBACNC,cACAC,UAAUF,QACVG,gBACAC,qDAECJ,mBACDE,UAAUF,MACTK,YAAeC,KAAKC,SAAQD,KAAKb,kBAC1Ba,KAAKL,MAAMI,SACnBJ,MAAMI,GAAOG,WAAW,aACtBL,iBACEM,GAAKR,MAAMI,IACjB,2CAGEK,IAAIC,oBAAoB,SAAUL,KAAKM,cAAc,qCAEjDC,QACJH,IAAMG,EAAIH,SACVH,KAAOM,EAAIN,UACXd,KAAOoB,EAAIpB,MAAQ,QACnBqB,MAAQD,EAAIC,QAAWC,EAAG,EAAGC,EAAG,QAChCC,QAAUJ,EAAII,kBACIJ,SAChBA,GAAIC,MAAMI,QAGVL,EAAIC,MAAMI,QAAQL,EAAIpB,MAIpBoB,EAAIC,MAAMI,QAAQL,EAAIpB,OATYoB,yCAanCH,GAAiBJ,KAAjBI,IAAKO,EAAYX,KAAZW,OACT,cAAeP,IAAOA,IAAQvB,UAC5BgC,WAAaF,EAAQF,IACrBK,UAAYH,EAAQD,KAEpBb,SAASc,EAAQF,EAAGE,EAAQD,kDAI1BN,EAAQJ,KAARI,IACFW,GAAeN,EAAG,EAAGC,EAAG,QACzBJ,aAAe,SAACU,MACfZ,IAAQvB,SACC4B,EAAI5B,OAAOoC,cACXP,EAAI7B,OAAOqC,gBACjB,OACuDF,EAAMG,OAA1DL,IAAAA,UAAWD,IAAAA,WAAYI,IAAAA,YAAaC,IAAAA,cACjCT,EAAII,GAAcK,GAAeL,IACjCH,EAAII,GAAaG,GAAeH,SAEtCM,OAAOC,EAAKV,QAASI,MAE1BO,iBAAiB,SAAUtB,KAAKM,cAAc,iCAa1CiB,IAA0BC,MAApB5C,KAAAA,UAAW6C,IAAAA,SACC,gBAAfA,GAAMxB,KAAmB,MAAOyB,GAAMrC,MAAM,sDACpC,WAAfoC,EAAMxB,KAAmB,MAAOyB,GAAMrC,MAAM,qCAC5CV,EAAOC,GAAY,IACK,gBAAf6C,GAAMtC,KAAmB,MAAOuC,GAAMrC,MAAM,qDACpDE,GAAS,GAAIE,QACT8B,OACCE,EAAMxB,UACNwB,EAAMtC,WACLqC,EAAMG,QAAQC,MAAMpB,MAAMiB,EAAMxB,cAC9BwB,EAAM3C,OAGfC,EAASH,OACRY,GAAW,GAAIC,QACXZ,YACC4C,EAAMxB,UACN,eACCuB,EAAMG,QAAQC,MAAMpB,MAAMiB,EAAMxB,cAC9BwB,EAAM5C,qCAIH0C,IAA0BC,MAApB5C,KAAAA,UAAW6C,IAAAA,KAC7B9C,GAAOC,MACNW,GAAOsC,YACHN,OACCE,EAAMxB,UACNwB,EAAMtC,WACLqC,EAAMG,QAAQC,MAAMpB,MAAMiB,EAAMxB,cAC9BwB,EAAM3C,OAGfC,EAASH,MACRY,GAASqC,YACLhD,YACC4C,EAAMxB,UACN,eACCuB,EAAMG,QAAQC,MAAMpB,MAAMiB,EAAMxB,cAC9BwB,EAAM5C,QAAU,wBAIvB0C,QAAM3C,KAAAA,SACRD,GAAOC,OACNW,GAAOuC,gBACHP,GAAGhC,IAERR,EAASH,OACRY,GAASsC,gBACLP,GAAG/B,0BE5HLuC,EAAMC,KACTC,UAAU,cAAexC"}