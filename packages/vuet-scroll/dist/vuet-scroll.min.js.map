{"version":3,"file":"vuet-scroll.min.js","sources":["../src/index.js","../../../src/util.js","../../../src/debug.js"],"sourcesContent":["import debug from '../../../src/debug'\nimport util from '../../../src/util'\n\nlet _Vue\nconst _self = '__vuetScrollSelf__'\nconst _window = '__vuetScrollWindow__'\n\nclass VuetScroll {\n  constructor (opts) {\n    this.timer = {}\n    this.setOption(opts)\n    this.scrollTo()\n    this.subScroll()\n  }\n  update (opts) {\n    this.setOption(opts)\n    const key = `timer-${this.path}-${this.name}`\n    clearTimeout(this.timer[key])\n    this.timer[key] = setTimeout(() => {\n      this.scrollTo()\n      delete this.timer[key]\n    }, 10)\n  }\n  destroy () {\n    this.app.removeEventListener('scroll', this.subScrolling, false)\n  }\n  setOption (opt) {\n    this.app = opt.app\n    this.path = opt.path\n    this.name = opt.name || ''\n    this.store = opt.store || { x: 0, y: 0 }\n    this.scrolls = opt.scrolls || createScroll(opt)\n    function createScroll (opt) {\n      if (!opt.store.$scroll) {\n        _Vue.set(opt.store, '$scroll', {})\n      }\n      if (!opt.store.$scroll[opt.name]) {\n        _Vue.set(opt.store.$scroll, opt.name, { x: 0, y: 0 })\n      }\n\n      return opt.store.$scroll[opt.name]\n    }\n  }\n  scrollTo () {\n    const { app, scrolls } = this\n    if ('scrollTop' in app && app !== window) {\n      app.scrollLeft = scrolls.x\n      app.scrollTop = scrolls.y\n    } else {\n      app.scrollTo(scrolls.x, scrolls.y)\n    }\n  }\n  subScroll () {\n    const { app } = this\n    const newScrolls = { x: 0, y: 0 }\n    this.subScrolling = (event) => {\n      if (app === window) {\n        newScrolls.x = window.pageXOffset\n        newScrolls.y = window.pageYOffset\n      } else {\n        const { scrollTop, scrollLeft, pageXOffset, pageYOffset } = event.target\n        newScrolls.x = scrollLeft || pageYOffset || scrollLeft\n        newScrolls.y = scrollTop || pageXOffset || scrollTop\n      }\n      Object.assign(this.scrolls, newScrolls)\n    }\n    app.addEventListener('scroll', this.subScrolling, false)\n  }\n}\n\nfunction isSelf (modifiers) {\n  return !!(modifiers.window !== true || modifiers.self)\n}\n\nfunction isWindow (modifiers) {\n  return !!(modifiers.window)\n}\n\nconst directive = {\n  inserted (el, { modifiers, value }, vnode) {\n    if (typeof value.path !== 'string') return debug.error('path is imperative parameter and is string type')\n    if (value.path === 'window') return debug.error('name cannot be the window name')\n    const store = vnode.context.$vuet.getState(value.path)\n    if (!util.isObject(store)) return debug.error(`'${value.path}' The module is not an object`)\n    if (isSelf(modifiers)) {\n      if (typeof value.name !== 'string') return debug.error('name is imperative parameter and is string type')\n      el[_self] = new VuetScroll({\n        app: el,\n        path: value.path,\n        name: value.name,\n        store,\n        scrolls: value.self\n      })\n    }\n    if (isWindow(modifiers)) {\n      el[_window] = new VuetScroll({\n        app: window,\n        path: value.path,\n        name: 'window',\n        store,\n        scrolls: value.window\n      })\n    }\n  },\n  componentUpdated (el, { modifiers, value }, vnode) {\n    const store = vnode.context.$vuet.getState(value.path)\n    if (!util.isObject(store)) return debug.error(`'${value.path}' The module is not an object`)\n    if (isSelf(modifiers)) {\n      el[_self].update({\n        app: el,\n        path: value.path,\n        name: value.name,\n        store,\n        scrolls: value.self\n      })\n    }\n    if (isWindow(modifiers)) {\n      el[_window].update({\n        app: window,\n        path: value.path,\n        name: 'window',\n        store,\n        scrolls: value.window || null\n      })\n    }\n  },\n  unbind (el, { modifiers }) {\n    if (isSelf(modifiers)) {\n      el[_self].destroy()\n      delete el[_self]\n    }\n    if (isWindow(modifiers)) {\n      el[_window].destroy()\n      delete el[_window]\n    }\n  }\n}\n\nexport default {\n  install (Vue) {\n    _Vue = Vue\n    Vue.directive('vuet-scroll', directive)\n  }\n}\n","const util = {\n  isObject (obj) {\n    return !!obj && Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  getArgMerge () {\n    let opt = {}\n    const args = arguments\n    if (typeof args[0] === 'string') {\n      opt[args[0]] = args.length > 1 ? args[1] : args[0]\n    } else if (args[0] && util.isObject(args[0])) {\n      opt = args[0]\n    }\n    return opt\n  },\n  isPromise (obj) {\n    return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function'\n  }\n}\n\nexport default util\n","import { _Vue } from './vuet-static'\n\nconst NAME = '__name__'\n\nexport default {\n  error (msg) {\n    throw new Error(`[${NAME}] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[${NAME}] ${msg}`)\n    }\n  },\n  assertModule (vuet, path) {\n    if (path in vuet.modules) {\n      return\n    }\n    this.error(`The '${path}' module does not exist`)\n  },\n  assertVue () {\n    if (!_Vue) {\n      this.error('must call Vue.use(Vuet) before creating a store instance')\n    }\n  },\n  assertFetch (vuet, path) {\n    this.assertModule(vuet, path)\n    if (typeof vuet.getModule(path).fetch !== 'function') {\n      this.error(`The '${path}' module 'fetch' method does not exist`)\n    }\n  }\n}\n"],"names":["isSelf","modifiers","window","self","isWindow","util","obj","Object","prototype","toString","call","opt","args","arguments","length","isObject","then","msg","Error","vuet","path","modules","error","assertModule","getModule","fetch","_Vue","_self","_window","VuetScroll","opts","timer","setOption","scrollTo","subScroll","key","this","name","setTimeout","_this","app","removeEventListener","subScrolling","store","x","y","scrolls","$scroll","set","scrollLeft","scrollTop","newScrolls","event","pageXOffset","pageYOffset","target","assign","_this2","addEventListener","directive","el","vnode","value","debug","context","$vuet","getState","update","destroy","Vue"],"mappings":"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"}