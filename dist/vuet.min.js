!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vuet=t.Vuet||{})}(this,function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),r=function(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},u={isObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},getArgMerge:function(){var t={},e=arguments;return"string"==typeof e[0]?t[e[0]]=e.length>1?e[1]:e[0]:e[0]&&u.isObject(e[0])&&(t=e[0]),t},isPromise:function(t){return("object"===(void 0===t?"undefined":e(t))||"function"==typeof t)&&!!t&&"function"==typeof t.then}},s=void 0,c={error:function(t){throw new Error("[vuet] "+t)},warn:function(t){},assertModule:function(t,e){e in t.modules||this.error("The '"+e+"' module does not exist")},assertVue:function(){s||this.error("must call Vue.use(Vuet) before creating a store instance")},assertFetch:function(t,e){this.assertModule(t,e),"function"!=typeof t.getModule(e).fetch&&this.error("'"+e+"' module 'fetch' must be the function type")}},a={rule:function(t){var e=t.path;return{beforeCreate:function(){c.assertFetch(this.$vuet,e),this.$vuet.getModule(e).fetch()}}}},f={init:function(t){t.__once__=[]},rule:function(t){var e=t.path;return{beforeCreate:function(){c.assertFetch(this.$vuet,e);var t=this.$vuet;if(!(t.__once__.indexOf(e)>-1)){var o=this.$vuet.getModule(e).fetch();if(u.isPromise(o))return o.then(function(o){t.__once__.push(e)});t.__once__.push(e)}}}}},l={rule:function(t){var e=t.path;return{beforeCreate:function(){c.assertModule(this.$vuet,e)},destroyed:function(){this.$vuet.getModule(e).reset()}}}},h={rule:function(t){var e=t.path;return{beforeCreate:function(){c.assertFetch(this.$vuet,e),this.$vuet.getModule(e).fetch()},destroyed:function(){this.$vuet.getModule(e).reset()}}}},d=function(){function t(e){var n=this;o(this,t),c.assertVue(),this.version="1.0.3",this.modules={},this.store={},this.options={pathJoin:"/",modules:{}},this.app=null,this.vm=new s({data:{modules:this.store}}),i(this.options,e),t.callRuleHook("init",this),Object.keys(this.options.modules).forEach(function(t){n.addModules(t,n.options.modules[t])})}return n(t,[{key:"_init",value:function(t){this.app=t}},{key:"addModules",value:function(e,o){var n=this;if(u.isObject(o.modules)&&Object.keys(o.modules).forEach(function(t){n.addModules(""+e+n.options.pathJoin+t,o.modules[t])}),"function"!=typeof o.data)return this;var r=this,a=i({},t.options.module,o);return s.set(r.store,e,a.data()),r.modules[e]=a,Object.defineProperty(a,"vuet",{get:function(){return r}}),Object.defineProperty(a,"app",{get:function(){return r.app}}),Object.defineProperty(a,"state",{get:function(){return r.store[e]},set:function(t){r.store[e]=t}}),Object.keys(a).forEach(function(t){if("function"==typeof a[t]){var o=a[t];a[t]=function(){return o.apply(r.modules[e],arguments)}}}),u.isObject(a.state)&&Object.keys(a.state).forEach(function(t){if(t in a)return c.warn("'"+e+"' the '"+t+"' already exists on the object");Object.defineProperty(a,t,{get:function(){return r.store[e][t]},set:function(o){r.store[e][t]=o}})}),t.callRuleHook("addModule",this,e),this.getModule(e)}},{key:"getModule",value:function(t){return c.assertModule(this,t),this.modules[t]}},{key:"getState",value:function(t){return c.assertModule(this,t),this.modules[t].state}},{key:"replaceStore",value:function(t){return this.store=this.vm.$data.modules=t,this}},{key:"destroy",value:function(){this.vm.$destroy(),t.callRuleHook("destroy",this)}}]),t}();!function(t){i(t,{installed:!1,options:{rules:{},module:{reset:function(){return this.state=this.data(),this}}},install:function(e){return this.installed?this:(this.installed=!0,s=e,Object.defineProperty(e.prototype,"$vuet",{get:function(){return this.$root._vuet}}),e.mixin({beforeCreate:function(){void 0!==this.$options.vuet&&this.$options.vuet instanceof t&&(this._vuet=this.$options.vuet,this._vuet._init(this))},destroyed:function(){void 0!==this.$options.vuet&&this.$options.vuet instanceof t&&this._vuet.destroy(this)}}),this)},mapModules:function(t){return{mixins:Object.keys(t).map(function(e){var o=t[e];return{computed:r({},e,{get:function(){return c.assertModule(this.$vuet,o),this.$vuet.getModule(o)},set:function(t){c.error("The'"+o+"'module is not allowed to assign")}})}})}},mapRules:function(){var e=u.getArgMerge.apply(null,arguments),o=[],n=function(e,n){var r=t.options.rules[e];u.isObject(r)||c.error("The'"+e+"'rule does not exist. Please make sure that it executes 'Vuet.rule('"+e+"', opts)' before all components"),"string"==typeof n?o.push(r.rule({path:n})):o.push(r.rule(n))};return Object.keys(e).forEach(function(t){var o=e[t];if(Array.isArray(o))return o.forEach(function(e){n(t,e)});n(t,o)}),{mixins:o}},rule:function(){return t.options.rules[arguments[0]]=arguments[1],"function"==typeof arguments[1].install&&arguments[1].install(t,s),this},callRuleHook:function(e){for(var o=arguments.length,n=Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];Object.keys(t.options.rules).forEach(function(o){"function"==typeof t.options.rules[o][e]&&t.options.rules[o][e].apply(void 0,n)})}})}(d),function(t){t.rule("need",a).rule("once",f).rule("temp",h).rule("reset",l)}(d);var p=d.mapRules.bind(d),y=d.mapModules.bind(d);t.mapRules=p,t.mapModules=y,t.default=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=vuet.min.js.map
